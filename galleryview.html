<!DOCTYPE html>
<html>
<body>

  <h1>Photogallery app</h1>
  <h2>Gallery view</h2>

  <img id="ImageView" src="images/default.jpg" alt="b image" width="592" height="444"> </p>


  <form action="/photogalleryweb/renamefile" method= "GET">
    <label for="OldCaption">Old Caption:</label><br>
    <input type="text" id="oldCaption" name="oldCaption" value="Old Caption"><br>
    <label for="NewCaption">New Caption:</label><br>
    <input type="text" id="newCaption" name="newCaption" value="New Caption"><br>
    <input type="submit" value="Rename File">
  </form>
  <br>

  <form action="/photogalleryweb/upload" method= "POST" enctype="multipart/form-data">
    Select a file: <input type="file" name="myFile"><br>
    <input type="submit"value="Upload">
  </form>
  <br>

  <button type="button" onclick="prevButton()"">Left</button>
  <button type="button" onclick="nextButton()"">Right</button>
  <br>

  <br>
  <button type="button" onclick="window.location.href = 'http://localhost:8081/photogalleryweb/searchview.html';">Search</button>
  <br>

  <br>
  Time:
  <div id="timeText"> Time textbox </div>
  Location:
  <div id="locationText"> Location textbox </div>
  
  <br>
  <button type="button" onclick="loadDoc()">Update List of Photos</button>
  <br>

  <br>
  Photo List:
  <div id="photoListText">
    Photo List
  </div>
  <br>

  Index:
  <div id="index">
    Index
  </div>
  <br>

  Current Photo:
  <div id="currentPhoto">
    Current Photo
  </div>
  <br>

  <script>
    index = 0;
    var photoArray;
    loadDoc();

    function loadDoc() 
    {
      var xhttp = new XMLHttpRequest();
      xhttp.onreadystatechange = function() 
      {
        if (this.readyState == 4 && this.status == 200) 
        {
          var photoList = this.responseText;
          photoArray = photoList.split(",");
		      photoArray[0] = photoArray[0].substring(4);

          document.getElementById("photoListText").innerHTML = photoArray;
          document.getElementById("ImageView").src = "images/" + photoArray[index];
        }
      };
      xhttp.open("GET", "directory", true);
      xhttp.send();
      updateCaption();
    }

    function prevButton()
    {
      if (index <= 0)
      {
        index = 0;
      }
      else
      {
        index--;
      }
      
      document.getElementById("ImageView").src = "images/" + photoArray[index];
      document.getElementById("index").innerHTML = index;
      document.getElementById("currentPhoto").innerHTML = "images/" + photoArray[index];
      updateCaption();
    }

    function nextButton()
    {
      if (index >= photoArray.length -1)
      {
        index = photoArray.length -1;
      }
      else
      {
        index++;
      }

      document.getElementById("ImageView").src = "images/" + photoArray[index];
      document.getElementById("index").innerHTML = index;
      document.getElementById("currentPhoto").innerHTML = "images/" + photoArray[index];
      updateCaption();
    }

    function updateCaption()
    {
      photoAttributes = photoArray[index].split("_");
      photoCaption = photoAttributes[0];
      photoTime = photoAttributes[1];
      photoLocation = photoAttributes[2];

      document.getElementById("oldCaption").value = photoCaption;
      document.getElementById("timeText").innerHTML = photoTime;
      document.getElementById("locationText").innerHTML = photoLocation;
    }

  </script>

</body>
</html>